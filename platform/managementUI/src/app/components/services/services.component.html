<div class="background">
  <h1 *ngIf="resource && resource.idShort">Operations for {{ resource.idShort }}</h1>
  <table>
    <tr>
      <td>
        <div *ngIf="resource">
          <div *ngFor="let basyxFunc of resource.value">
            <div *ngIf="basyxFunc.invokable">
              <div>
                <button mat-raised-button (click)="showFuncInput(basyxFunc)">{{ basyxFunc.idShort }}</button>
              </div>
            </div>
          </div>
        </div>
      </td>
      <td>
        <div *ngIf="selectedBasyxFunc">
          <div> {{ selectedBasyxFunc.idShort }}</div>
          <div *ngFor="let func of selectedBasyxFunc.inputVariables; let i = index">
            <p>
              <mat-form-field appearance="outline">
                <mat-label>{{ func.value.idShort }}</mat-label>
                <input [(ngModel)]=value[i].value.value matInput >
              </mat-form-field>
            </p>
          </div>
          <button mat-raised-button (click)="send()">Abschicken</button>
        </div>
      </td>
    </tr>
  </table>
  <br>
  <h1>Services <span *ngIf="resource && resource.idShort">for {{ resource.idShort }}</span></h1>
  <div *ngIf="services && services.submodelElements" style="display: flex;">
    <div *ngFor="let element of services.submodelElements">
      <mat-card *ngIf="element.idShort != 'deviceRegistry' && element.idShort != 'deviceManager' && element.idShort != 'containers'" tabindex="0" style="flex: 1 1 100%; flex-wrap: wrap;">
        <mat-card-title>{{ element.idShort }}</mat-card-title>
        <mat-card-content>
          <div *ngFor="let element2 of element.value">
            <div *ngIf="!element2.invokable">
              <span class="service">{{ element2.idShort }}: </span>
                <div *ngFor="let element3 of element2.value">
                  <span class="shortId"> {{ element3.idShort }}</span>
                  <span *ngIf="!isObject(element3.value); else isobject"> {{ element3.value }} </span>
                  <ng-template #isobject>
                    <div *ngFor="let element4 of element3.value">
                      <span *ngIf="element4.idShort != 'type'"> {{ element4.idShort }}:  {{ element4.value }}</span>
                    </div>
                  </ng-template>
                </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <h1>available Artifacts</h1>
  <button mat-raised-button (click)="getArtifacts()">refresh Artifacts</button>
  <div>
    <div *ngFor="let element of artifacts.submodelElements; let i = index">
      <mat-card  *ngIf="!element.invokable" tabindex="0">
        <mat-card-title>
          <mat-icon *ngIf="artifactsToggle[i]">keyboard_arrow_down</mat-icon>
          <mat-icon *ngIf="!artifactsToggle[i]">keyboard_arrow_right</mat-icon>
          <button mat-raised-button (click)="toggle(i)">{{ element.idShort }}</button>
        </mat-card-title>
        <mat-card-content *ngIf="artifactsToggle[i]">
          <div *ngFor="let element2 of element.value">
            <div class="button" *ngIf="!element2.invokable">
              <span class="shortId">{{ element2.idShort }}: </span>
              <div *ngIf="isArray(element2.value); else noArray ">
                <div *ngFor="let element3 of element2.value">
                  <span *ngIf="element3.value"> {{ element3.value | tidy}} </span>
                </div>
              </div>
              <ng-template #noArray>{{ element2.value | tidy}}</ng-template>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
