<?xml version="1.0" encoding="UTF-8"?>
<project name="configuration.easy" default="maven" basedir=".">
	<!-- import of the global SSE Jenkins properties -->
	<property file="${user.home}/global-build.properties"/>
	<property file="${user.home}/qualimaster-build.properties"/>
	<include file="${user.home}/macros.xml"/>
    <property environment="env"/>
    <property name="iip.build.initial" value="${env.iipbuildinitial}"/>
    <property name="genFolder" value="./target/gen"/>
    <property name="genFolderTests" value="${genFolder}/tests"/>
	
    <!-- deploy to SSE Mvn repo -->
	<target name="maven"> 
        <exec executable="/bin/bash">
          <arg value="${basedir}/cleanup.sh"/>
        </exec>	
		
	    <maven pomFile="pom.xml" goal="install">
          <arg value="-Dmodel.parent=${model_parent}"/> <!-- must be set in jenkins ANT build step -->
          <arg value="-Diip.tests=true"/>
          <arg value="-Diip.ciBuildId=${build_num}"/> <!-- must be set in jenkins ANT build step -->
          <arg value="-Dokto.mvn.home=${maven.bin.dir}/bin"/>
        </maven>
		
        <mvnDeployResolveArtifact folderName="IIP-configuration.easy" pomFile="pom.xml" jarFolder="target" artifactPattern="configuration.easy-*.*.*.jar" />

        <ant dir="${genFolderTests}/SimpleMesh/ApplicationInterfaces" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/SimpleMesh3/ApplicationInterfaces" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/KodexMesh/ApplicationInterfaces" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/RoutingTest/ApplicationInterfaces" antfile="build-jk.xml" />
	
		<mvnDeployResolveArtifact folderName="IIP-test.configuration.easy" pomFile="test.configuration.configuration/pom.xml" jarFolder="test.configuration.configuration/target" artifactPattern="apps.ServiceImpl-*.*.*.jar" />

        <ant dir="${genFolderTests}/SimpleMesh/SimpleMeshTestingApp" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/SimpleMesh3/SimpleMeshTestingApp3" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/KodexMesh/SimpleKodexTestingApp" antfile="build-jk.xml" />
        <ant dir="${genFolderTests}/RoutingTest/RoutingTestApp" antfile="build-jk.xml" />

        <exec executable="/bin/bash">
          <arg value="${basedir}/cleanup.sh"/>
        </exec>	
	</target>
</project>
