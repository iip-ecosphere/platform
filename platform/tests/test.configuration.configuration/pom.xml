<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <artifactId>apps.ServiceImpl</artifactId>
  <packaging>jar</packaging>
  <name>GeneratedStreamImpl</name>
  <description>Implementation components for generated test streams (configuration.configuration).</description>

  <parent>
     <groupId>de.iip-ecosphere.platform</groupId>
     <artifactId>platformDependencies</artifactId>
     <version>0.3.0-SNAPSHOT</version>
  </parent>

  <dependencies>
    <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
    </dependency>
    <dependency>
     <groupId>de.iip-ecosphere.platform</groupId>
     <artifactId>services.environment</artifactId>
     <version>${project.version}</version>
    </dependency>
    <dependency>
     <!-- shared plattform app interfaces, here just for lazy testing in different artifact -->
     <artifactId>apps.AppInterfacesSimpleMesh</artifactId>
     <groupId>de.iip-ecosphere.platform</groupId>
     <version>${project.version}</version>
    </dependency>
    <dependency>
     <!-- shared plattform app interfaces, here just for lazy testing in different artifact -->
     <artifactId>apps.AppInterfacesSimpleMesh3</artifactId>
     <groupId>de.iip-ecosphere.platform</groupId>
     <version>${project.version}</version>
    </dependency>
    <dependency>
     <!-- shared plattform app interfaces, here just for lazy testing in different artifact -->
     <artifactId>apps.AppInterfacesKodex</artifactId>
     <groupId>de.iip-ecosphere.platform</groupId>
     <version>${project.version}</version>
    </dependency>    
  
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <scope>test</scope>
    </dependency>
  </dependencies>
  
  <build>
     <!-- Basic puild process inherited from platformDependencies. -->
     <plugins>
        <plugin>
            <!-- Obtain generated python sources from Maven repository (shall be deployed there) -->
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>3.2.0</version>
            <executions>
                <execution>
                    <id>unpack python</id>
                    <goals>
                        <goal>unpack</goal>
                    </goals>
                    <phase>process-sources</phase>
                    <configuration>
                        <artifactItems>
                            <!-- List the artifacts to unpack. We just do that for the SimpleKodexTestingApp.
                                 This project is a multi-app/multi-service testing project, a rather unusual
                                 but for CI testing convenient form. Typically there shall be just one project
                                 per app so that the python sources cannot overlap/interfere. -->
                            <artifactItem>
                                <groupId>de.iip-ecosphere.platform</groupId>
                                <artifactId>apps.AppInterfacesKodex</artifactId>
                                <version>${project.version}</version>
                                <type>zip</type>
                                <classifier>python</classifier>
                                <overWrite>true</overWrite>
                                <outputDirectory>${project.basedir}/src/main/python</outputDirectory>
                                <destFileName>pythonEnv.zip</destFileName>
                            </artifactItem>
                        </artifactItems>
                    </configuration>
                </execution>
            </executions>
        </plugin>
         <plugin>
             <!-- When the usual build process is done, package also the implementing Python code. As this will
                  be automatically integrated with the generated code, we exclude in the assembly descriptor the
                  generated python sources, i.e., do not modify these sources, just the Python files in "services". -->
             <groupId>org.apache.maven.plugins</groupId>
             <artifactId>maven-assembly-plugin</artifactId>
             <version>3.1.1</version>
             <executions>
                 <execution>
                     <id>python</id>
                     <phase>test</phase>
                     <goals>
                         <goal>single</goal>
                     </goals>
                     <configuration>
                         <descriptors>
                             <descriptor>src/main/assembly/python.xml</descriptor>
                         </descriptors>
                         <outputDirectory>${project.build.directory}</outputDirectory>
                         <attach>true</attach>
                     </configuration>
                 </execution>
             </executions>
         </plugin>
     </plugins>
    <pluginManagement>
        <plugins>
            <!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.-->
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>
                                        org.apache.maven.plugins
                                    </groupId>
                                    <artifactId>
                                        maven-dependency-plugin
                                    </artifactId>
                                    <versionRange>
                                        [3.1.2,)
                                    </versionRange>
                                    <goals>
                                        <goal>unpack</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <ignore></ignore>
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
  </build>

</project>
